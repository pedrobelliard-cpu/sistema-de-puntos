<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gesti√≥n - Innovaci√≥n</title>
    <style>
        /* --- ESTILOS VISUALES --- */
        :root {
            --primary: #2563eb;       
            --secondary: #1e293b;     
            --accent: #10b981;        
            --bg: #f1f5f9;            
            --card: #ffffff;          
            --danger: #ef4444;
        }

        body { font-family: 'Segoe UI', system-ui, sans-serif; background-color: var(--bg); color: var(--secondary); margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }

        /* HEADER */
        .header { display: flex; justify-content: space-between; align-items: center; background: var(--card); padding: 20px 30px; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); margin-bottom: 30px; }
        .header h1 { margin: 0; font-size: 22px; color: var(--secondary); text-transform: uppercase; letter-spacing: 0.5px; }
        .header p { margin: 5px 0 0; color: #64748b; font-size: 14px; font-weight: 500; }
        
        .actions { display: flex; gap: 10px; }

        .btn-main { background: var(--primary); color: white; border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 8px; }
        .btn-main:hover { background: #1d4ed8; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2); }

        .btn-print { background: var(--secondary); color: white; border: none; padding: 12px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px; }
        .btn-print:hover { background: #334155; }

        /* KPI CARDS */
        .kpi-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { background: var(--card); padding: 25px; border-radius: 12px; border: 1px solid #e2e8f0; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        .kpi-title { font-size: 13px; text-transform: uppercase; letter-spacing: 1px; color: #64748b; font-weight: 700; }
        .kpi-number { font-size: 36px; font-weight: 800; margin-top: 10px; color: var(--secondary); }
        
        /* GR√ÅFICAS */
        .charts-section { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 25px; margin-bottom: 30px; }
        .chart-box { background: var(--card); padding: 25px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        .chart-header { font-weight: bold; margin-bottom: 20px; font-size: 18px; border-bottom: 2px solid #f1f5f9; padding-bottom: 10px; }
        
        .bar-container { display: flex; align-items: center; margin-bottom: 15px; font-size: 14px; }
        .bar-name { width: 140px; text-align: right; padding-right: 15px; font-weight: 500; color: #475569; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .bar-bg { flex: 1; background: #f1f5f9; height: 28px; border-radius: 6px; overflow: hidden; position: relative; }
        .bar-fill { height: 100%; display: flex; align-items: center; justify-content: flex-end; padding-right: 10px; color: white; font-weight: bold; font-size: 12px; transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1); }

        /* TABLA */
        .table-box { background: var(--card); border-radius: 12px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        table { width: 100%; border-collapse: collapse; text-align: left; }
        th { background: #f8fafc; padding: 18px 25px; font-size: 12px; text-transform: uppercase; color: #64748b; font-weight: 700; border-bottom: 1px solid #e2e8f0; }
        td { padding: 18px 25px; border-bottom: 1px solid #f1f5f9; color: #334155; }
        tr:last-child td { border-bottom: none; }
        tr:hover { background-color: #f8fafc; }
        .badge { background: #dbeafe; color: #1e40af; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: bold; }
        .id-cell { font-family: monospace; font-weight: bold; color: #64748b; background: #f1f5f9; padding: 4px 8px; border-radius: 4px; font-size: 13px; }
        
        .btn-delete { background: transparent; border: 1px solid #fee2e2; color: var(--danger); padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; transition: all 0.2s; }
        .btn-delete:hover { background: var(--danger); color: white; }

        /* MODAL */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(4px); z-index: 100; justify-content: center; align-items: center; }
        .modal-content { background: white; width: 90%; max-width: 450px; padding: 30px; border-radius: 16px; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); animation: slideIn 0.3s ease; }
        
        @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .form-label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 14px; color: #475569; }
        .form-input { width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; margin-bottom: 16px; font-size: 15px; outline: none; transition: border 0.2s; box-sizing: border-box; }
        .form-input:focus { border-color: var(--primary); }
        
        .btn-group { display: flex; gap: 10px; margin-top: 10px; }
        .btn-save { flex: 2; background: var(--secondary); color: white; border: none; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .btn-cancel { flex: 1; background: transparent; color: #64748b; border: 2px solid #e2e8f0; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .btn-save:hover { background: #0f172a; }

        @media print {
            .actions, .btn-delete, th:last-child, td:last-child { display: none !important; }
            body { background: white; padding: 0; }
            .container { max-width: 100%; }
            .card, .chart-box, .table-box { box-shadow: none; border: 1px solid #ccc; }
        }

    </style>
</head>
<body>

    <div class="container">
        
        <div class="header">
            <div>
                <h1>Dep. Investigaci√≥n Aplicada a la Innovaci√≥n</h1>
                <p>Sistema de Gesti√≥n de Puntos</p>
            </div>
            <div class="actions">
                <button class="btn-print" onclick="window.print()">
                    üñ®Ô∏è Imprimir Reporte
                </button>
                <button class="btn-main" onclick="abrirModal()">
                    <span>+</span> Nuevo Gestor
                </button>
            </div>
        </div>

        <div class="kpi-grid">
            <div class="card">
                <div class="kpi-title">Total Gestores</div>
                <div class="kpi-number" id="kpi-total">0</div>
            </div>
            <div class="card">
                <div class="kpi-title">Puntos Acumulados</div>
                <div class="kpi-number" id="kpi-puntos" style="color: var(--primary);">0</div>
            </div>
            <div class="card">
                <div class="kpi-title">L√≠der Actual</div>
                <div class="kpi-number" id="kpi-lider" style="font-size: 24px; color: var(--accent);">---</div>
            </div>
        </div>

        <div class="charts-section">
            <div class="chart-box">
                <div class="chart-header">üèÜ Ranking por Puntos</div>
                <div id="chart-points"></div>
            </div>
            <div class="chart-box">
                <div class="chart-header">üí° Actividad (Ideas)</div>
                <div id="chart-ideas"></div>
            </div>
        </div>

        <div class="table-box">
            <div class="chart-header" style="margin: 0; padding: 20px 25px; border-bottom: 1px solid #e2e8f0;">
                Directorio de Gestores Activos
            </div>
            <table>
                <thead>
                    <tr>
                        <th style="width: 100px;">ID Empleado</th>
                        <th>Nombre Completo</th>
                        <th>Departamento</th>
                        <th>Puntos (PI)</th>
                        <th>Talleres</th>
                        <th>Ideas</th>
                        <th style="text-align: center;">Acci√≥n</th>
                    </tr>
                </thead>
                <tbody id="table-body"></tbody>
            </table>
        </div>

    </div>

    <div class="modal-overlay" id="modal">
        <div class="modal-content">
            <h2 style="margin-top: 0; margin-bottom: 20px; color: var(--secondary);">Registrar Nuevo Gestor</h2>
            <form id="form-gestor" onsubmit="guardarDatoLocal(event)">
                
                <label class="form-label">N√∫mero de Empleado (4 d√≠gitos)</label>
                <input type="text" id="input-id" class="form-input" placeholder="Ej: 1001" maxlength="4" pattern="\d{4}" title="Debe ser 4 d√≠gitos num√©ricos" required>

                <label class="form-label">Nombre del Colaborador</label>
                <input type="text" id="input-nombre" class="form-input" placeholder="Ej: Maria Gonzalez" required>
                
                <label class="form-label">Departamento</label>
                <select id="input-depto" class="form-input">
                    <option value="Tecnolog√≠a">Tecnolog√≠a</option>
                    <option value="Recursos Humanos">Recursos Humanos</option>
                    <option value="Ventas">Ventas</option>
                    <option value="Operaciones">Operaciones</option>
                    <option value="Finanzas">Finanzas</option>
                    <option value="Investigaci√≥n">Investigaci√≥n</option>
                </select>

                <div style="display: flex; gap: 15px;">
                    <div style="flex: 1;">
                        <label class="form-label">Puntos</label>
                        <input type="number" id="input-puntos" class="form-input" placeholder="0" required>
                    </div>
                    <div style="flex: 1;">
                        <label class="form-label">Ideas</label>
                        <input type="number" id="input-ideas" class="form-input" placeholder="0" required>
                    </div>
                </div>

                <div class="btn-group">
                    <button type="button" class="btn-cancel" onclick="cerrarModal()">Cancelar</button>
                    <button type="submit" class="btn-save">Guardar Registro</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // --- BASE DE DATOS (Con IDs √∫nicos) ---
        let datos = [
            { id: "1045", name: "Jorge Tonos", depto: "Tecnolog√≠a", points: 1500, talleres: 4, ideas: 6 },
            { id: "2033", name: "Iris Cesa", depto: "Recursos Humanos", points: 1200, talleres: 3, ideas: 3 },
            { id: "3012", name: "Rosanny Contreras", depto: "Operaciones", points: 1100, talleres: 2, ideas: 4 },
            { id: "4056", name: "Cesar Diaz", depto: "Ventas", points: 950, talleres: 2, ideas: 1 },
            { id: "5088", name: "Ramon Sanchez", depto: "Finanzas", points: 800, talleres: 1, ideas: 2 }
        ];

        function renderizar() {
            // Ordenar por puntos (Mayor a menor)
            datos.sort((a, b) => b.points - a.points);

            // KPIs
            document.getElementById('kpi-total').textContent = datos.length.toLocaleString(); // Formato con comas para miles
            const totalPuntos = datos.reduce((sum, item) => sum + parseInt(item.points), 0);
            document.getElementById('kpi-puntos').textContent = totalPuntos.toLocaleString();
            document.getElementById('kpi-lider').textContent = datos.length > 0 ? datos[0].name : "---";

            // Gr√°ficas
            const maxPoints = Math.max(...datos.map(d => d.points)) || 100;
            const chartPoints = document.getElementById('chart-points');
            chartPoints.innerHTML = ""; 
            
            // Limitamos la gr√°fica a los TOP 10 para que no se vea gigante si hay 1000 empleados
            datos.slice(0, 10).forEach(d => {
                const percent = (d.points / maxPoints) * 100;
                chartPoints.innerHTML += `
                    <div class="bar-container">
                        <div class="bar-name">${d.name}</div>
                        <div class="bar-bg">
                            <div class="bar-fill" style="width: ${percent}%; background-color: var(--primary);">
                                ${d.points}
                            </div>
                        </div>
                    </div>
                `;
            });

            // Gr√°fica Ideas (Top 10)
            const maxIdeas = Math.max(...datos.map(d => d.ideas)) || 10;
            const chartIdeas = document.getElementById('chart-ideas');
            chartIdeas.innerHTML = ""; 
            
            datos.slice(0, 10).forEach(d => {
                const percent = (d.ideas / maxIdeas) * 100;
                chartIdeas.innerHTML += `
                    <div class="bar-container">
                        <div class="bar-name">${d.name}</div>
                        <div class="bar-bg">
                            <div class="bar-fill" style="width: ${percent}%; background-color: var(--accent);">
                                ${d.ideas}
                            </div>
                        </div>
                    </div>
                `;
            });

            // Tabla Completa (Aqu√≠ s√≠ salen todos)
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = "";
            
            datos.forEach((d, index) => {
                tbody.innerHTML += `
                    <tr>
                        <td><span class="id-cell">${d.id}</span></td>
                        <td style="font-weight: 600;">${d.name}</td>
                        <td><span class="badge">${d.depto}</span></td>
                        <td style="color: var(--primary); font-weight: 800;">${d.points}</td>
                        <td>${d.talleres}</td>
                        <td>${d.ideas}</td>
                        <td style="text-align: center;">
                            <button class="btn-delete" onclick="eliminarGestor(${index})">üóëÔ∏è</button>
                        </td>
                    </tr>
                `;
            });
        }

        function guardarDatoLocal(e) {
            e.preventDefault();
            const nuevoGestor = {
                id: document.getElementById('input-id').value,
                name: document.getElementById('input-nombre').value,
                depto: document.getElementById('input-depto').value,
                points: parseInt(document.getElementById('input-puntos').value) || 0,
                talleres: 0,
                ideas: parseInt(document.getElementById('input-ideas').value) || 0
            };
            
            // Validar que el ID no exista ya (opcional pero profesional)
            const existe = datos.find(d => d.id === nuevoGestor.id);
            if(existe) {
                alert("¬°Error! Ese n√∫mero de empleado ya existe en el sistema.");
                return;
            }

            datos.push(nuevoGestor);
            renderizar();
            cerrarModal();
            document.getElementById('form-gestor').reset();
        }

        function eliminarGestor(index) {
            const nombre = datos[index].name;
            if (confirm(`¬øEliminar gestor ${nombre} del sistema?`)) {
                datos.splice(index, 1);
                renderizar();
            }
        }

        function abrirModal() { document.getElementById('modal').style.display = 'flex'; }
        function cerrarModal() { document.getElementById('modal').style.display = 'none'; }

        renderizar();
    </script>
</body>
</html>
